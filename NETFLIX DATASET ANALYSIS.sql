CREATE DATABASE NETFLIX;
USE NETFLIX;  
 
-- COUNT TOTAL NUMBER OF RECORDS
SELECT COUNT(*) AS TOTAL_RECORDS
FROM TITLES; 

-- DISTRIBUTION OF TYPE 
SELECT TYPE, COUNT(*) AS COUNT 
FROM TITLES
GROUP BY TYPE
ORDER BY COUNT DESC;   

-- DISTRIBUTION OF RAATING 
SELECT RATING, COUNT(*) AS COUNT 
FROM TITLES
GROUP BY RATING
ORDER BY COUNT DESC; 

-- DISTRIBUTION OF RELEASE YEAR 
SELECT RELEASE_YEAR,COUNT(*) AS COUNT 
FROM TITLES
GROUP BY RELEASE_YEAR
ORDER BY RELEASE_YEAR;   

-- TOP 10 MOST COMMON DIRECTORS
SELECT DIRECTOR, COUNT(*) AS COUNT 
FROM TITLES
GROUP BY DIRECTOR
ORDER BY COUNT DESC 
LIMIT 10;  

-- TOP 10 COUNTRIES
SELECT COUNTRY,COUNT(*) AS COUNT 
FROM TITLES
GROUP BY COUNTRY
ORDER BY COUNT DESC
LIMIT 10;  

-- RECORDS ADDED PER MONTH 
SELECT DATE_FORMAT(STR_TO_DATE(DATE_ADDED,'%B %D, %Y'), '%Y-%m') AS 
MONTH, COUNT(*) AS COUNT
FROM TITLES
GROUP BY month
ORDER BY MONTH;  


-- RECORD ADDED PER YEAR 
SELECT YEAR(STR_TO_DATE(DATE_ADDED, '%B %d, %Y')) AS YEAR, COUNT(*) AS COUNT
FROM TITLES
GROUP BY year
ORDER BY YEAR; 

-- COUNT DRAMAS RECORDS
SELECT COUNT(*) AS COUNT
FROM TITLES
WHERE LISTED_IN LIKE '%DRAMAS%';  

-- AVERAGE DURATION OF MOVIES/ SHOWS
SELECT AVG(CAST(SUBSTRING_INDEX(DURATION,' ',1) AS UNSIGNED)) AS
AVERAGE_DURATION 
FROM TITLES
WHERE DURATION REGEXP '^[0-9]+ MIN$'; 

-- FIND RECORDS WITH NO DIRECTOR INFO
SELECT COUNT(*) AS COUNT
FROM TITLES
WHERE DIRECTOR="";  

-- RECORD RELEASED IN LAST 5 YEARS
SELECT *
FROM TITLES
WHERE RELEASE_YEAR >=YEAR(CURDATE()) - 5; 

-- RECORDS FOR INDIA COUNTRY
SELECT TYPE, TITLE
FROM TITLES
WHERE COUNTRY = 'INDIA';  

-- FIND RECORDS WHICH HAVE SEASONS 
SELECT *
FROM TITLES
WHERE DURATION LIKE '%SEASONS%'; 

-- RECORDS WHICH HAVE MORE THAN 2 SEASONS 
SELECT *
FROM TITLES
WHERE DURATION LIKE '%SEASONS%'
AND CAST(SUBSTRING_INDEX(SUBSTRING_INDEX(DURATION, ' ', 1), ' ', -1) AS 
UNSIGNED) >2;  